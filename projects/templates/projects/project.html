{% extends 'base.html' %}
{% load project_extra %}
{% load bootstrap4 %}
{% block content %}
<h2>{{project.title}}</h2>
<ul class="nav nav-tabs">
  <li class="nav-item">
    <a class="nav-link active" href="#" data-target="div_tasks" id="link_div_tasks">Taches</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="#" data-target="div_project" id="link_div_project">Projet</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="#" data-target="div_members" id="link_div_members">Gérer les membres</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="#" data-target="div_update" id="link_div_update">Modifier le projet</a>
  </li>
</ul>
<div id="div_tasks" style="display:block">
ajouter une tache + liste des taches réparties en colonne + gestion des taches
</div>
<div id="div_project" style="display:none">
<table class="table table-striped">
  <tbody>
    <tr>
      <td colspan="2" width="50%">Description</td>
	  <td colspan="2" width="50%">{{project.description}}</td>
    </tr>
    <tr>
      <td>Création</td>
	  <td>{{project.creationDate}}</td>
      <td>Créateur</td>
	  <td>{{project.owner}}</td>
    </tr>
    <tr>
      <td>Projet actif</td>
	  <td>{% if project.active %}Oui{% else %}Non{% endif %}</td>
      <td>Nombre de membres</td>
	  <td>{{project.users.count}}</td>
    </tr>
	<tr>
		<td>Nombre de tâches</td>
		<td>{{project.task_set.count}}</td>
		<td>Nombre de tâches To Do</td>
		<td>{{todo}}</td>
	</tr>
	<tr>
		<td>Nombre de tâches Doing</td>
		<td>{{doing}}</td>
		<td>Nombre de tâches Done</td>
		<td>{{done}}</td>
  </tbody>
</table>
</div>
<div id="div_members" style="display:none">
<br>
<h5>Ajouter un membre</h5>
<form method="post" action="" class="form">
	{% csrf_token %}
	{% bootstrap_form addMemberForm %}
	<button class="btn btn-outline-primary"><i class="fa fa-user-plus"></i> Ajouter le membre</button>
</form>
<hr>
<h5>Passasse de créateur</h5>
Désigner le nouveau créateur (chef de projet):
<hr>
<h5>Liste des membres</h5>
<table class="table table-striped">
	<thead>
		<tr>
			<th>Nom d'utilisateur</th>
			<th>Nombre de tâches papsées</th>
			<th>Role</th>
			<th>Administrer</th>
		</tr>
	</thead>
	<tbody>
		{% for member in project.users.all %}
		<tr>
			<td>{{member.username}} {% if member == project.owner %}<i class="fa fa-star"></i>{% endif %}</td>
			<td>{{taken_tasks|index:forloop.counter0}}</td>
			<td></td>
			<td>{% if member != project.owner %}<a class="btn btn-outline-danger" href="{% url 'projects:deleteUserFromProject' project.pk member.pk %}"><i class="fa fa-times"></i> Retirer du projet</a>{% endif %}</td>
		</tr>
		{% endfor %}
	</tbody>
</table>
</div>
<div id="div_update" style="display:none">
<br>
<h5>Modifier le projet</h5>
<form action="" method="post" class="form">
	{% csrf_token %}
	{% bootstrap_form projectForm %}
	<button class="btn btn-outline-primary"><i class="fa fa-pencil-alt"></i> Modifier</button>
</form>
<br>
<br>
</div>


<script>
		$(document).ready(function(){
			prec = "div_tasks"
			$(".nav-link").click(function(){
				$("#" + prec).attr('style','display:none');
				$("#link_" + prec).removeClass("active");
				$("#" + $(this).attr('data-target')).attr('style','display:block');
				$("#link_" + $(this).attr('data-target')).addClass('active');
				prec = $(this).attr('data-target');
			});
		});
	</script>

{% endblock %}
